from pyspark.sql import SparkSession 
from pyspark.sql.types import StructType, StructField 
from pyspark.sql.types import DoubleType, IntegerType, StringType,FloatType 
schema = StructType([StructField("d_date1", StringType()), StructField("location1", StringType()),StructField("Id_number1", StringType()),StructField("customer1", StringType()),StructField("scada_conn1", StringType()),StructField("today_kvarh1", StringType()),StructField("avg_wind_speed1", StringType()),StructField("generation_year1", StringType()),StructField("gen_today_kwh1", StringType()),StructField("gen_yesterday_kwh1", StringType()),StructField("grid_ss_owner1", StringType()),StructField("grid_internal_vestas", StringType()),StructField("internal_line_uss_maintance_vestas", StringType()),StructField("unschedule_services_vestas", StringType()),StructField("schedule_services_vestas", StringType()),StructField("enviro_powerica", StringType()),StructField("owner_powerica", StringType()),StructField("wtg_error_detail", StringType()),StructField("grid_error_detail", StringType()),StructField("gen_ion_day", StringType()),StructField("prod_today_hr", StringType()),StructField("prod_yesterday_hr", StringType()),StructField("prod_hrs_day", StringType()),StructField("daily_capacity", FloatType()),StructField("gen_from_1st_april_to_now", StringType()),StructField("grid_avail", StringType()),StructField("plf_till_date", StringType()),StructField("total_stoppadge_uss_grid_vestas", StringType()),StructField("up_2_sub_station_mac_avail", StringType()),StructField("net_machine_avail", StringType()),StructField("total_stoppage", FloatType())])

spark = SparkSession.builder.appName("csvdemoup").config("spark.some.config.option", "sale").getOrCreate() 
df = spark.read.csv("E:/working-directory/BITOOL_DONE/datasource/csvFiles/2019-08-24-15-20_dgr.csv",header=True,mode="DROPMALFORMED",sep=",",schema=schema) 
df.write.format("jdbc").options(url="jdbc:mysql://127.0.0.1:3306/db_demo",driver="com.mysql.cj.jdbc.Driver",dbtable="tbl_sdemo",user="root",password="Admin@123").mode("overwrite").save() 
