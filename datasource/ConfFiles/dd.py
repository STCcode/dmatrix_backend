from pyspark.sql import SparkSession 
from pyspark.sql.types import StructType, StructField 
from pyspark.sql.types import DoubleType, IntegerType, StringType,FloatType 
schema = StructType([StructField("Link", StringType()),StructField("Global Dimension 2 Code", StringType()),StructField("Entry Type", StringType()),StructField("Document No_", StringType()),StructField("Description", StringType()),StructField("value", StringType()),StructField("Source Code", StringType()),StructField("QTY", StringType()),StructField("BEZ", StringType()),StructField("Posting Date", StringType()),StructField("System", StringType()),StructField("Gen_ Bus_ Posting Group", StringType()),StructField("Gen_ Prod_ Posting Group", StringType()),StructField("Source Posting Group", StringType()),StructField("Item Ledger Entry Type", StringType()),StructField("User ID", StringType()),StructField("Dimension Set ID", StringType()),StructField("MFR Line", StringType()),StructField("KstSt", StringType()),StructField("Contr/OPC", StringType()),StructField("Posted at", StringType()),StructField("Mon", StringType()),StructField("Jahr", StringType()),StructField("Cognos Cust", StringType()),StructField("Segment", StringType()),StructField("Diameter", StringType()),StructField("Hot_foil", StringType()),StructField("IBL", StringType()),StructField("Insert", StringType()),StructField("Shoulder_Colour", StringType()),StructField("Shoulder_Type_Thread", StringType()),StructField("Silk_screening", StringType()),StructField("Top_Seal", StringType()),StructField("Tube_Length", StringType()),StructField("Web Type", StringType()),StructField("Entry No_", StringType())]) 
spark = SparkSession.builder.appName("dd").config("spark.some.config.option", "sale").getOrCreate() 
df = spark.read.csv("e:/working-directory/bi/datasource/csvFiles/sales_QTY_LM-CM.csv",header=True,mode="DROPMALFORMED",sep=",",schema=schema) 
df.write.format("jdbc").options(url="jdbc:mysql://127.0.0.1:3306/db_demo",driver="com.mysql.cj.jdbc.Driver",dbtable="tbl_csvsp_demo",user="root",password="Admin@123").mode("overwrite").save() 
