from pyspark.sql import SparkSession 
from pyspark.sql.types import StructType, StructField 
from pyspark.sql.types import DoubleType, IntegerType, StringType,FloatType 
schema = StructType([StructField("d_date", StringType()),StructField("location", StringType()),StructField("Id_number", StringType()),StructField("customer", StringType()),StructField("scada_conn", StringType()),StructField("today_kvarh", StringType()),StructField("avg_wind_speed", StringType()),StructField("generation_year", StringType()),StructField("gen_today_kwh", StringType()),StructField("gen_yesterday_kwh", StringType()),StructField("grid_ss_owner", StringType()),StructField("grid_internal_vestas", StringType()),StructField("internal_line_uss_maintance_vestas", StringType()),StructField("unschedule_services_vestas", StringType()),StructField("schedule_services_vestas", StringType()),StructField("enviro_powerica", StringType()),StructField("owner_powerica", StringType()),StructField("wtg_error_detail", StringType()),StructField("grid_error_detail", StringType()),StructField("gen_ion_day", StringType()),StructField("prod_today_hr", StringType()),StructField("prod_yesterday_hr", StringType()),StructField("prod_hrs_day", StringType()),StructField("daily_capacity", StringType()),StructField("gen_from_1st_april_to_now", StringType()),StructField("grid_avail", StringType()),StructField("plf_till_date", StringType()),StructField("total_stoppadge_uss_grid_vestas", StringType()),StructField("up_2_sub_station_mac_avail", StringType()),StructField("net_machine_avail", StringType()),StructField("total_stoppage", StringType())]) 
spark = SparkSession.builder.appName("demosummery").config("spark.some.config.option", "sale").getOrCreate() 
df = spark.read.csv("D:/Shikha_working_directory/bi-vertib/datasource/csvFiles/2019-08-24-15-20_dgr.csv",header=True,mode="DROPMALFORMED",sep=",",schema=schema) 
df.write.format("jdbc").options(url="jdbc:mysql://127.0.0.1:3306/db_demo",driver="com.mysql.cj.jdbc.Driver",dbtable="tbl_demodgr",user="root",password="Admin@123").mode("overwrite").save() 
